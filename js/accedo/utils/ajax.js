accedo.define("accedo.utils.ajax",["accedo.utils.object","accedo.utils.fn","accedo.utils.string"],function(){var a=function(){return accedo.Try(function(){return new XMLHttpRequest();},function(){return new ActiveXObject("Msxml2.XMLHTTP");},function(){return new ActiveXObject("Microsoft.XMLHTTP");})||false;};return{_getTransport:function(){return accedo.Try(function(){return new XMLHttpRequest();},function(){return new ActiveXObject("Msxml2.XMLHTTP");},function(){return new ActiveXObject("Microsoft.XMLHTTP");})||false;},request:function(c,b){return new (function(){this.url="";this._complete=false;this.transport=a();this.onStateChange=function(){var e=this.transport.readyState;if(e>1&&!((e===4)&&this._complete)){this.respondToReadyState(e);}};this.respondToReadyState=function(i){try{if(i===4){this._complete=true;var j=this.transport.status;var m=true;if((!j||(j>=200&&j<300)||j===304)){var l=this.transport.responseText;if(accedo.utils.string.isJSON(l)){this.transport.responseJSON=accedo.utils.string.parseJSON(l);}if(accedo.utils.object.isFunction(this.options.onSuccess)){this.options.onSuccess(this.transport);}}else{m=false;if(accedo.utils.object.isFunction(this.options.onFailure)){this.options.onFailure(this.transport);}}if(accedo.utils.object.isFunction(this.options.onComplete)){this.options.onComplete(this.transport,m);}}}catch(k){if(accedo.utils.object.isFunction(this.options.onException)){this.options.onException(this.transport,k);}}};this.resend=function(){};this.abort=function(){try{this.transport.abort();}catch(i){}if(accedo.utils.object.isFunction(this.options.onAbort)){this.options.onAbort();}};this.url=c;this.options={method:"get",async:true,contentType:"text/plain",encoding:"UTF-8",parameters:""};accedo.utils.object.extend(this.options,b||{});this.options.method=this.options.method.toLowerCase();var h=accedo.utils.object.isString(this.options.parameters)?this.options.parameters:(accedo.utils.object.isFunction(this.options.parameters.toQueryString)?this.options.parameters.toQueryString():"");if(["get","post"].indexOf(this.options.method)===-1){h+=(h?"&":"")+"_method="+this.options.method;this.options.method="post";}if(accedo.utils.object.isString(h)&&h.length>0){this.url+=((this.url.indexOf("?")>0)?"&":"?")+h;}try{this.transport.open(this.options.method.toUpperCase(),this.url,this.options.async);this.transport.onreadystatechange=accedo.utils.fn.bind(this.onStateChange,this);var g=this.options.requestHeaders||{};if(this.options.method=="post"){g["Content-type"]=this.options.contentType+(this.options.encoding?"; charset="+this.options.encoding:"");}var d;for(d in g){this.transport.setRequestHeader(d,g[d]);}this.body=this.options.method==="post"?(this.options.postBody||h):null;this.transport.send(this.body);if(!this.options.async&&this.transport.overrideMimeType){this.onStateChange();}}catch(f){if(accedo.utils.object.isFunction(this.options.onException)){this.options.onException(this.transport,f);}}})();}};});