accedo.define("nfb.lgAPI",null,function(){var a=function(f){if(f.match(/</)){return document.getElementsByTagName(f.match(/<(.*)>/)[1]);}return document.getElementById(f);};var c={CONTAINER_NAME:"lgVideoPlayer",appendTo:null,videoURL:"",videoWidth:640,videoHeight:480,videoTop:100,videoLeft:100,autoPlay:false,videoDownloadable:true,initialize:false,videoDebug:false,playerObj:null,playerContainer:null,curTimerStarted:false,curTimeCounterInterval:1000,onLoadCallback:function(){},onCurTimeCallback:function(){},playStateCallback:function(){},onStopCallback:function(){},generatePlayer:function(h){if(this.videoDebug){d.create();d.show();}if(this.initialize){d.pushMsg("player is initialized");return;}d.pushMsg("player start initializing");var i=false;if(h){if(typeof h.width!="undefined"){this.videoWidth=h.width;}if(typeof h.height!="undefined"){this.videoHeight=h.height;}if(typeof h.top!="undefined"){this.videoTop=h.top;}if(typeof h.left!="undefined"){this.videoLeft=h.left;}if(h.url){this.videoURL=h.url;}if(h.autoPlay){i=h.autoPlay;this.autoPlay=h.autoPlay;}if(h.parent){this.appendTo=h.parent;}if(h.onLoadCallback){this.onLoadCallback=h.onLoadCallback;}if(h.onCurTimeCallback){this.onCurTimeCallback=h.onCurTimeCallback;}if(h.onPlayStateCallback){this.onPlayStateCallback=h.onPlayStateCallback;}if(h.onStopCallback){this.onStopCallback=h.onStopCallback;}}var f=document.createElement("div");f.id=this.CONTAINER_NAME;f.style.backgroundColor="#000000";f.style.position="absolute";f.style.width=this.videoWidth+"px";f.style.height=this.videoHeight+"px";f.style.left=this.videoLeft+"px";f.style.top=this.videoTop+"px";console.log("videoWidth is "+this.videoWidth);if(this.videoWidth<1280){console.log("************this is a small screen video");f.style.zIndex="2001";}try{var g=document.createElement("object");g.setAttribute("type","application/x-mp4");g.setAttribute("data",this.videoURL);g.setAttribute("width",this.videoWidth);g.setAttribute("height",this.videoHeight);g.setAttribute("downloadable",this.videoDownloadable);g.setAttribute("id",this.CONTAINER_NAME+"_obj");g.style.width=this.videoWidth+"px";g.style.height=this.videoHeight+"px";this.playerObject=g;f.appendChild(g);f.obj=g;}catch(j){alert("lgVideoPlayer error: \ncreate the player object: \n"+j);return;}if(this.appendTo==null){document.getElementsByTagName("body")[0].appendChild(f);}else{try{document.getElementById(this.appendTo).appendChild(f);}catch(j){alert("lgVideoPlayer error: "+j);return;}}this.playerContainer=f;c.postGeneratePlayer();return f;},postGeneratePlayer:function(){var f=a(c.CONTAINER_NAME+"_obj");if(typeof f!="undefined"){c.playerObject=f;if(c.videoURL!=""&&c.videoURL!=null&&c.autoPlay==true){c.playerObject.autoStart=true;}else{if(c.videoURL!=""&&c.videoURL!=null&&c.autoPlay!=true){c.playerObject.autoStart=false;}}c.playerObject.onPlayStateChange=c.playStateChangeCallback;c.playerObject.onReadyStateChange=c.readyStateChangeCallback;c.playerObject.onBuffering=c.bufferingCallback;c.playerObject.onError=c.errorCallback;c.initialize=true;d.pushMsg("player loading finished");c.onLoadCallback();d.pushMsg("onLoadCallback finished");}else{d.pushMsg("not yet get the playerObject");setTimeout("lgVideoPlayer.postGeneratePlayer()",1000);}},destroyPlayer:function(){if(!this.initialize){return;}d.pushMsg("==== player object destory ====");d.hide();this.onLoadCallback=function(){};this.onCurTimeCallback=function(){};this.onPlayStateCallback=function(){};this.onStopCallback=function(){};this.videoURL="";c.curTimeCounterStop();this.initialize=false;this.playerContainer.removeChild(this.playerObject);},play:function(f){if(!this.initialize){return;d.pushMsg("play() player not initialized");}if(this.videoURL==""||this.videoURL==null){d.pushMsg("no video url");return;}if(typeof f=="undefined"){f=1;}this.playerObject=a(this.CONTAINER_NAME+"_obj");d.pushMsg("play("+f+") video URL "+this.videoURL);if(this.playerObject.playState!=3&&this.playerObject.playState!=4&&this.playerObject.playState!=6){try{this.playerObject.play(f);d.pushMsg("play("+f+") triggered");}catch(g){d.pushMsg("play("+f+") error");console.log("error: "+g);}}},pause:function(){if(!this.initialize){return;d.pushMsg("play(0) player not initialized");}if(this.videoURL==""||this.videoURL==null){d.pushMsg("no video url");return;}this.playerObject=a(this.CONTAINER_NAME+"_obj");if(this.playerObject.playState!=0&&this.playerObject.playState!=2&&this.playerObject.playState!=3&&this.playerObject.playState!=4&&this.playerObject.playState!=5&&this.playerObject.playState!=6){try{this.playerObject.play(0);d.pushMsg("play(0) triggered");}catch(f){d.pushMsg("play(0) error");}}},stop:function(){if(!this.initialize){return;}if(this.videoURL==""||this.videoURL==null){d.pushMsg("no video url");return;}this.playerObject=a(this.CONTAINER_NAME+"_obj");if(this.playerObject.playState!=0){try{this.playerObject.stop();this.curTimeCounterStop();d.pushMsg("stop()");}catch(f){d.pushMsg("error stop()");}}else{if(this.playerObject.playState==0){d.pushMsg("already stopped");}}},skip:function(i){d.pushMsg("skip("+i+")");if(!this.initialize){d.pushMsg("return");return;}if(this.videoURL==""||this.videoURL==null){d.pushMsg("no video url");return;}this.playerObject=a(this.CONTAINER_NAME+"_obj");if(this.playerObject.playState==1||this.playerObject.playState==2){var g=c.playerObject.mediaPlayInfo();var f=g.currentPosition;var h=g.duration;if(f+i*1000>h){d.pushMsg("skip() to the end");this.playerObject.seek(h-1000);}else{if(f+i*1000<0){d.pushMsg("skip() to the beginning");this.playerObject.seek(0);}else{d.pushMsg("skip to ("+f+i*1000+")");this.playerObject.seek(f+i*1000);}}}else{d.pushMsg("skip() not work in video not playing");}d.pushMsg("skip done");},seek:function(f){d.pushMsg("seek("+f+")");if(!this.initialize){d.pushMsg("return");return;}if(this.videoURL==""||this.videoURL==null){d.pushMsg("no video url");return;}this.playerObject=a(this.CONTAINER_NAME+"_obj");if(this.playerObject.playState==1||this.playerObject.playState==2){var h=c.playerObject.mediaPlayInfo();var g=h.currentPosition;var i=h.duration;if(f<=0){d.pushMsg("seek() exceed lower range");this.playerObject.seek(0);}else{if(f>=i){d.pushMsg("seek() exceed upper range");this.playerObject.seek(i-1000);}else{this.playerObject.seek(f);}}}else{d.pushMsg("seek() not work in video not playing");}d.pushMsg("seek done");},curTimeCounterStart:function(){if(c.playerObject.playState==0&&c.playerObject.playState==5&&c.playerObject.playState==6){d.pushMsg("not in the correct state to start timer");return;}else{if(c.curTimerStarted==true){d.pushMsg("timer already started");return;}else{d.pushMsg("curTimeCounter started");c.curTimerStarted=true;c.curTimeCounter();}}MX.videoLoading.hide();},curTimeCounterStop:function(){d.pushMsg("curTimeCounter manually stopped");c.curTimerStarted=false;},curTimeCounter:function(){if(!c.initialize){return;}if(c.curTimerStarted==false){return;}c.curTimeCallback();if(c.playerObject.playState==0&&c.playerObject.playState==5&&c.playerObject.playState==6){d.pushMsg("curTimeCounter stopped");c.curTimerStarted=false;return;}setTimeout(c.curTimeCounter,c.curTimeCounterInterval);},playStateChangeCallback:function(){c.playerObject=a(c.CONTAINER_NAME+"_obj");var f=c.playerObject.playState;d.pushMsg("PlayState: "+f);if(f==1||f==2||f==4){c.curTimeCounterStart();}else{if(f==0||f==5||f==6){c.curTimeCounterStop();c.onStopCallback();}}c.onPlayStateCallback(f);d.updatePlayState(f);d.updateMediaInfo(c.playerObject.mediaPlayInfo());},readyStateChangeCallback:function(){c.playerObject=a(c.CONTAINER_NAME+"_obj");var f=c.playerObject.readyState;d.pushMsg("ReadyState: "+f);d.updateReadyState(f);d.updateMediaInfo(c.playerObject.mediaPlayInfo());},bufferingCallback:function(){c.playerObject=a(c.CONTAINER_NAME+"_obj");var f=c.playerObject.playState;d.pushMsg("Buffering: "+f);d.updateBuffering(f);d.updateMediaInfo(c.playerObject.mediaPlayInfo());},errorCallback:function(){c.playerObject=a(c.CONTAINER_NAME+"_obj");var f=c.playerObject.error;d.pushMsg("Error: "+f);d.updateError(f);d.updateMediaInfo(c.playerObject.mediaPlayInfo());},curTimeCallback:function(){var f=c.playerObject.mediaPlayInfo();if(typeof f.duration!="undefined"&&typeof f.currentPosition!="undefined"&&typeof f.bufRemain!="undefined"&&typeof f.bitrateInstant!="undefined"&&typeof f.bitrateTarget!="undefined"){this.onCurTimeCallback(f.currentPosition,f.duration,f.bufRemain,f.bitrateInstant,f.bitrateTarget);}d.updateMediaInfo(c.playerObject.mediaPlayInfo());},formatCurTime:function(h,i,g){h=Math.round(h/1000);i=Math.round(i/1000);if(typeof g=="undefined"||h>3600||i>3600){g=false;}var j=Math.floor(h/3600);var o=Math.floor((h%3600)/60);var p=Math.floor((h%60));var n=Math.floor(i/3600);var f=Math.floor((i%3600)/60);var l=Math.floor((i%60));if((""+o).length==1){o="0"+o;}if((""+p).length==1){p="0"+p;}if((""+f).length==1){f="0"+f;}if((""+l).length==1){l="0"+l;}var m="";if(!g){m+=j+":";}m+=o+":"+p;var k="";if(!g){k+=n+":";}k+=f+":"+l;return{current:m,duration:k};}};var d={isCreated:false,messageSlot:[],create:function(){if(this.isCreated){return;}var f=document.createElement("div");f.style.zIndex=30000;f.style.width="500px";f.style.height="500px";f.style.top="0px";f.style.left="780px";f.style.position="absolute";f.style.backgroundColor="#ffffff";f.style.color="#000000";var g=document.createElement("div");g.innerHTML="Video Debug";g.style.fontSize="28px";g.style.position="absolute";g.style.left="20px";g.style.top="20px";f.appendChild(g);this.content=document.createElement("div");this.content.innerHTML="";this.content.style.fontSize="16px";this.content.style.position="absolute";this.content.style.left="20px";this.content.style.top="60px";this.content.style.width="460px";this.content.style.height="350px";f.appendChild(this.content);this.playState=document.createElement("div");this.playState.innerHTML="PlayState: N/A";this.playState.style.fontSize="14px";this.playState.style.position="absolute";this.playState.style.left="20px";this.playState.style.top="400px";f.appendChild(this.playState);this.readyState=document.createElement("div");this.readyState.innerHTML="ReadyState: N/A";this.readyState.style.fontSize="16px";this.readyState.style.position="absolute";this.readyState.style.left="20px";this.readyState.style.top="420px";f.appendChild(this.readyState);this.buffering=document.createElement("div");this.buffering.innerHTML="buffering: N/A";this.buffering.style.fontSize="16px";this.buffering.style.position="absolute";this.buffering.style.left="20px";this.buffering.style.top="440px";f.appendChild(this.buffering);this.error=document.createElement("div");this.error.innerHTML="error: N/A";this.error.style.fontSize="16px";this.error.style.position="absolute";this.error.style.left="20px";this.error.style.top="460px";f.appendChild(this.error);this.mediaInfo=document.createElement("div");this.mediaInfo.innerHTML="MediaInfo:<br/>N/A";this.mediaInfo.style.fontSize="16px";this.mediaInfo.style.position="absolute";this.mediaInfo.style.left="270px";this.mediaInfo.style.top="360px";this.mediaInfo.style.width="200px";this.mediaInfo.style.height="100px";this.mediaInfo.style.color="#0000FF";f.appendChild(this.mediaInfo);document.getElementsByTagName("body")[0].appendChild(f);this.container=f;this.isCreated=true;},show:function(){if(!this.isCreated){return;}this.container.style.display="block";},hide:function(){if(!this.isCreated){return;}setTimeout(function(){d.container.style.display="none";},2000);},pushMsg:function(g){if(!this.isCreated){return;}this.messageSlot.push(g);while(this.messageSlot.length>15){this.messageSlot.shift();}this.content.innerHTML="";for(var f=0;f<this.messageSlot.length;f++){this.content.innerHTML+=this.messageSlot[f]+"<br/>";}},updatePlayState:function(f){if(!this.isCreated){return;}var g="";switch(f){case 0:g="stopped";break;case 1:g="playing";break;case 2:g="paused";break;case 3:g="connecting";break;case 4:g="buffering";break;case 5:g="finished";break;case 6:g="error";break;}this.playState.innerHTML="PlayState: "+f+" "+g;},updateReadyState:function(f){if(!this.isCreated){return;}this.readyState.innerHTML="ReadyState: "+f;},updateBuffering:function(f){if(!this.isCreated){return;}this.buffering.innerHTML="buffering: "+f;},updateError:function(f){if(!this.isCreated){return;}var g="";switch(f){case 0:g="A/V format not supported";break;case 1:g="Cannot connect to server or connection lost";break;case 2:g="Unidentified error";break;case 3:g="File is not found";break;case 4:g="Invalid protocol";break;case 5:g="DRM failure";break;case 6:g="Play list is empty";break;case 7:g="Unrecognized play list";break;case 8:g="Invalid ASX format";break;case 9:g="Error in downloading play list";break;case 10:g="Out of memory";break;case 11:g="Invalid URL list format";break;case 12:g="Not playable in play list";break;case 1100:g="Unidentified WM-DRM error";break;case 1101:g="Incorrect license in local license store";break;case 1102:g="Fail in receiving correct license from server";break;case 1103:g="Stored license is expired";break;}this.error.innerHTML="error: "+f+" "+g;},updateMediaInfo:function(f){if(!this.isCreated){return;}if(typeof f!="undefined"){this.mediaInfo.innerHTML="MediaInfo:<br/>";if(typeof f.duration!="undefined"){this.mediaInfo.innerHTML+="duration "+f.duration+"<br/>";}if(typeof f.currentPosition!="undefined"){this.mediaInfo.innerHTML+="currentPosition "+f.currentPosition+"<br/>";}if(typeof f.bufRemain!="undefined"){this.mediaInfo.innerHTML+="bufRemain "+f.bufRemain+"<br/>";}if(typeof f.bitrateInstant!="undefined"){this.mediaInfo.innerHTML+="bitrateInstant "+f.bitrateInstant+"<br/>";}if(typeof f.bitrateTarget!="undefined"){this.mediaInfo.innerHTML+="bitrateTarget "+f.bitrateTarget+"<br/>";}}}};var b=function(){if(typeof nfb.lgAPI.currentView.onmouseon!="undefined"){nfb.lgAPI.currentView.onmouseon();}};var e=function(){if(typeof nfb.lgAPI.currentView.onmouseoff!="undefined"){nfb.lgAPI.currentView.onmouseoff();}};return{lgVideoPlayer:c,videoDebug:d,onmouseon:b,onmouseoff:e};});